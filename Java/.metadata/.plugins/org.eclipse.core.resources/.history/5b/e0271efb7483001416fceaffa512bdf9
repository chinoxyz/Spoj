import java.io.*;
import java.math.*;
import java.util.*;

class CNTPRIME {
	
	public static int MAXN=1000009;
	public static BitSet primes=new BitSet(MAXN);
	public static BitSet arr=new BitSet(MAXN);
	static int n;
	static int q;
	
	static void pree()
	{
		primes.set(0,MAXN);
		
		for(int i=2;i*i<=MAXN;++i)
		{
			if(primes.get(i))
			{
				for(int j=i*i;j<MAXN;j+=i)
				{
					primes.set(j,false);
				}
			}
		}
	}

	public static void main(String[] args) {
		// TODO Auto-generated method stub
		
		pree();
		
		try
		{
			//System.out.println("DDD");
			BufferedReader br = null;
			br = new BufferedReader(new FileReader(".\\Text\\CNTPRIME.txt"));
			//br = new BufferedReader(new InputStreamReader(System.in));
			
			int cases;
			cases=Integer.parseInt(br.readLine());
			int i;
			int x,y,v;
			int ret;
			
			
			
			for(int t=1;t<=cases;++t)
			{
				
				arr.clear();
				String a[]=br.readLine().split(" ");
				n=Integer.parseInt(a[0]);
				q=Integer.parseInt(a[1]);
				
				String b[]=br.readLine().split(" ");
				
				System.out.println("DD\n");
				
				for(i=1;i<=n;++i)
				{
					if(primes.get(Integer.parseInt(b[i-1])))
					{
						arr.set(i);
					}
				}
				System.out.println("Case "+t+":");
				while(q-- > 0)
				{
					
					String c[]=br.readLine().split(" ");
					
					if(c[0]=="1")
					{
						x=Integer.parseInt(c[1]);
						y=Integer.parseInt(c[2]);
						
						BitSet tb=(BitSet)arr.clone();
						arr.clear(0,x);
						arr.clear(y+1,MAXN);
						
						System.out.println(arr.cardinality());
						arr=(BitSet)tb.clone();
						
					}
					else
					{
						x=Integer.parseInt(c[1]);
						y=Integer.parseInt(c[2]);
						v=Integer.parseInt(c[3]);
						
						if(primes.get(v))
						{
							arr.set(x,y+1);
						}
						else
						{
							arr.clear(x,y+1);
						}
					}
				}
				
			}			
		}
		catch(Exception e)
		{
			
		}

	}

}
